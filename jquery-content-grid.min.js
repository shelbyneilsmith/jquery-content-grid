!function(t){function e(t){return"object"==typeof t?t:{top:t,left:t}}var n=t.scrollTo=function(e,n,i){t(window).scrollTo(e,n,i)};n.defaults={axis:"xy",duration:parseFloat(t.fn.jquery)>=1.3?0:1,limit:!0},n.window=function(e){return t(window)._scrollable()},t.fn._scrollable=function(){return this.map(function(){var e=this,n=!e.nodeName||-1!=t.inArray(e.nodeName.toLowerCase(),["iframe","#document","html","body"]);if(!n)return e;var i=(e.contentWindow||e).document||e.ownerDocument||e;return/webkit/i.test(navigator.userAgent)||"BackCompat"==i.compatMode?i.body:i.documentElement})},t.fn.scrollTo=function(i,a,c){return"object"==typeof a&&(c=a,a=0),"function"==typeof c&&(c={onAfter:c}),"max"==i&&(i=9e9),c=t.extend({},n.defaults,c),a=a||c.duration,c.queue=c.queue&&c.axis.length>1,c.queue&&(a/=2),c.offset=e(c.offset),c.over=e(c.over),this._scrollable().each(function(){function o(t){d.animate(v,a,c.easing,t&&function(){t.call(this,i,c)})}if(null!==i){var s,r=this,d=t(r),l=i,v={},u=d.is("html,body");switch(typeof l){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(l)){l=e(l);break}if(l=t(l,this),!l.length)return;break;case"object":(l.is||l.style)&&(s=(l=t(l)).offset())}t.each(c.axis.split(""),function(t,e){var i="x"==e?"Left":"Top",a=i.toLowerCase(),f="scroll"+i,h=r[f],b=n.max(r,e);if(s)v[f]=s[a]+(u?0:h-d.offset()[a]),c.margin&&(v[f]-=parseInt(l.css("margin"+i))||0,v[f]-=parseInt(l.css("border"+i+"Width"))||0),v[f]+=c.offset[a]||0,c.over[a]&&(v[f]+=l["x"==e?"width":"height"]()*c.over[a]);else{var p=l[a];v[f]=p.slice&&"%"==p.slice(-1)?parseFloat(p)/100*b:p}c.limit&&/^\d+$/.test(v[f])&&(v[f]=v[f]<=0?0:Math.min(v[f],b)),!t&&c.queue&&(h!=v[f]&&o(c.onAfterFirst),delete v[f])}),o(c.onAfter)}}).end()},n.max=function(e,n){var i="x"==n?"Width":"Height",a="scroll"+i;if(!t(e).is("html,body"))return e[a]-t(e)[i.toLowerCase()]();var c="client"+i,o=e.ownerDocument.documentElement,s=e.ownerDocument.body;return Math.max(o[a],s[a])-Math.min(o[c],s[c])}}(jQuery),function(t){function e(e,n){var i=t(".grid-square.active");"next"===n&&(i=i.next()),"prev"===n&&(i=i.prev()),i.trigger("click")}function n(e,n){var i={scrollTop:t(e).offset().top};t("html,body").animate(i,"fast","swing",function(){"function"==typeof n&&n(),n=null})}t.ContentGrid=function(e){var n={container:t(".content-grid"),directionNav:!1,ajax:!1,getActiveContent:function(){console.log("Set up an active content callback function!")}};this.settings=t.extend({},n,e)},t.ContentGrid.prototype.init=function(){var e=this;if(this.settings.container.length>0){var n="<div class='active-container' tabindex='1'>";n+="<div class='active-controls'>",n+="<span class='close-btn active-btn' title='Close'>Close</span>",this.settings.directionNav&&(n+="<span class='prev-btn active-btn' title='Previous'>Previous</span>",n+="<span class='next-btn active-btn' title='Next'>Next</span>"),n+="</div>",n+="<div class='content'></div>",n+="</div>",this.settings.container.before(n),t(".grid-square").each(function(){t(this).bind("click",function(t){e.showActive(t)})}),this.bindActiveBtns()}},t.ContentGrid.prototype.showActive=function(i){var a;t(".active-container").hasClass("active")&&this.hideActive(),a="undefined"==typeof i.target?i.srcElement:i.target;var c=t(a).closest(".grid-square"),o=this;return c.hasClass("active")||(c.addClass("active"),n("#content",function(){if(t(".active-container").hasClass("active")||(t(".active-container").addClass("active").focus(),o.settings.directionNav&&t(".active-container").bind("keydown",function(t){39==t.which&&e(t,"next"),37==t.which&&e(t,"prev")})),o.settings.ajax){t(".active-container").prepend('<div class="grid-loading"></div>');var n=o.settings.ajax.ajaxDataFunction(c);t.ajax({url:o.settings.ajax.url,data:n,success:function(e){t(".active-container .grid-loading").remove(),t(".active-container .content").html(e).fadeIn("fast",function(){var e,n=0;t(".active-container .content").children().each(function(){var i=t(this);parseInt(i.css("height"))>n&&(e=this,n=parseInt(i.css("height")))}),t(".active-container").css("min-height",n),o.settings.ajax.successCallback(c)})}})}else o.settings.getActiveContent(c);t(".grid-square.active").is(".grid-square:last-of-type")?t(".active-container.active .next-btn").addClass("disabled").unbind("click"):t(".active-container.active .next-btn").hasClass("disabled")&&t(".active-container.active .next-btn").removeClass("disabled").bind("click",function(t){e(t,"next")}),t(".grid-square.active").is(".grid-square:first-of-type")?t(".active-container.active .prev-btn").addClass("disabled").unbind("click"):t(".active-container.active .prev-btn").hasClass("disabled")&&t(".active-container.active .prev-btn").removeClass("disabled").bind("click",function(t){e(t,"prev")})})),!1},t.ContentGrid.prototype.bindActiveBtns=function(){var n=this;t(".active-container .close-btn").fadeIn().bind("click",function(e){t(".active-container").unbind("keydown"),t(".active-container").css("min-height",""),t(".active-container.active").removeClass("active"),n.hideActive()}),n.settings.directionNav&&(t(".active-container .next-btn").fadeIn().bind("click",function(t){e(t,"next")}),t(".active-container .prev-btn").fadeIn().bind("click",function(t){e(t,"prev")}))},t.ContentGrid.prototype.hideActive=function(){t(".grid-square.active").removeClass("active"),t(".active-container .content").fadeOut("fast",function(){t(".active-container .content").html("")})}}(jQuery);
