!function(t){function e(t){return"object"==typeof t?t:{top:t,left:t}}var n=t.scrollTo=function(e,n,i){t(window).scrollTo(e,n,i)};n.defaults={axis:"xy",duration:parseFloat(t.fn.jquery)>=1.3?0:1,limit:!0},n.window=function(e){return t(window)._scrollable()},t.fn._scrollable=function(){return this.map(function(){var e=this,n=!e.nodeName||-1!=t.inArray(e.nodeName.toLowerCase(),["iframe","#document","html","body"]);if(!n)return e;var i=(e.contentWindow||e).document||e.ownerDocument||e;return/webkit/i.test(navigator.userAgent)||"BackCompat"==i.compatMode?i.body:i.documentElement})},t.fn.scrollTo=function(i,a,c){return"object"==typeof a&&(c=a,a=0),"function"==typeof c&&(c={onAfter:c}),"max"==i&&(i=9e9),c=t.extend({},n.defaults,c),a=a||c.duration,c.queue=c.queue&&c.axis.length>1,c.queue&&(a/=2),c.offset=e(c.offset),c.over=e(c.over),this._scrollable().each(function(){function o(t){l.animate(d,a,c.easing,t&&function(){t.call(this,i,c)})}if(null!==i){var s,r=this,l=t(r),v=i,d={},u=l.is("html,body");switch(typeof v){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(v)){v=e(v);break}if(v=t(v,this),!v.length)return;break;case"object":(v.is||v.style)&&(s=(v=t(v)).offset())}t.each(c.axis.split(""),function(t,e){var i="x"==e?"Left":"Top",a=i.toLowerCase(),f="scroll"+i,h=r[f],p=n.max(r,e);if(s)d[f]=s[a]+(u?0:h-l.offset()[a]),c.margin&&(d[f]-=parseInt(v.css("margin"+i))||0,d[f]-=parseInt(v.css("border"+i+"Width"))||0),d[f]+=c.offset[a]||0,c.over[a]&&(d[f]+=v["x"==e?"width":"height"]()*c.over[a]);else{var b=v[a];d[f]=b.slice&&"%"==b.slice(-1)?parseFloat(b)/100*p:b}c.limit&&/^\d+$/.test(d[f])&&(d[f]=d[f]<=0?0:Math.min(d[f],p)),!t&&c.queue&&(h!=d[f]&&o(c.onAfterFirst),delete d[f])}),o(c.onAfter)}}).end()},n.max=function(e,n){var i="x"==n?"Width":"Height",a="scroll"+i;if(!t(e).is("html,body"))return e[a]-t(e)[i.toLowerCase()]();var c="client"+i,o=e.ownerDocument.documentElement,s=e.ownerDocument.body;return Math.max(o[a],s[a])-Math.min(o[c],s[c])}}(jQuery),function(t){function e(e,n){var i=t(".grid-square.active");"next"===n&&(i=i.next()),"prev"===n&&(i=i.prev()),i.trigger("click")}function n(e,n){var i={scrollTop:t(e).offset().top};t("html,body").animate(i,"fast","swing",function(){"function"==typeof n&&n(),n=null})}t.ContentGrid=function(e){var n={container:t(".content-grid"),directionNav:!1,ajax:!1,getActiveContent:function(){return"Set up an active content callback function!"},contentCallback:function(){console.log("Do you want to do something after the active container is filled?")}};this.settings=t.extend({},n,e)},t.ContentGrid.prototype.init=function(){var e=this;if(this.settings.container.length>0){var n="<div class='active-container' tabindex='1'>";n+="<div class='active-controls'>",n+="<span class='close-btn active-btn' title='Close'>Close</span>",this.settings.directionNav&&(n+="<span class='prev-btn active-btn' title='Previous'>Previous</span>",n+="<span class='next-btn active-btn' title='Next'>Next</span>"),n+="</div>",n+="<div class='content'></div>",n+="</div>",this.settings.container.before(n),t(".grid-square").each(function(){t(this).bind("click",function(t){e.showActive(t)})}),this.bindActiveBtns()}},t.ContentGrid.prototype.showActive=function(i){var a;t(".active-container").hasClass("active")&&this.hideActive(),a="undefined"==typeof i.target?i.srcElement:i.target;var c=t(a).closest(".grid-square"),o=this;return c.hasClass("active")||(c.addClass("active"),n("#content",function(){if(t(".active-container").hasClass("active")||(t(".active-container").addClass("active").focus(),o.settings.directionNav&&t(".active-container").bind("keydown",function(t){39==t.which&&e(t,"next"),37==t.which&&e(t,"prev")})),o.settings.ajax){t(".active-container").prepend('<div class="grid-loading"></div>');var n=o.settings.ajax.ajaxDataFunction(c);t.ajax({url:o.settings.ajax.url,data:n,success:function(e){t(".active-container .grid-loading").remove(),o.populateActiveContent(e,o.settings.contentCallback)}})}else{var i=o.settings.getActiveContent();o.populateActiveContent(i,o.settings.contentCallback)}t(".grid-square.active").is(".grid-square:last-of-type")?t(".active-container.active .next-btn").addClass("disabled").unbind("click"):t(".active-container.active .next-btn").hasClass("disabled")&&t(".active-container.active .next-btn").removeClass("disabled").bind("click",function(t){e(t,"next")}),t(".grid-square.active").is(".grid-square:first-of-type")?t(".active-container.active .prev-btn").addClass("disabled").unbind("click"):t(".active-container.active .prev-btn").hasClass("disabled")&&t(".active-container.active .prev-btn").removeClass("disabled").bind("click",function(t){e(t,"prev")})})),!1},t.ContentGrid.prototype.populateActiveContent=function(e,n){t(".active-container .content").html(e).fadeIn("fast",function(){var e,i=100;t(".active-container .content").children().each(function(){var n=t(this);if(parseInt(n.css("height"))>i){e=this;var a=parseInt(n.css("height"));a>i&&(i=a)}}),t(".active-container").css("min-height",i),n()})},t.ContentGrid.prototype.bindActiveBtns=function(){var n=this;t(".active-container .close-btn").fadeIn().bind("click",function(e){t(".active-container").unbind("keydown"),t(".active-container").css("min-height",""),t(".active-container.active").removeClass("active"),n.hideActive()}),n.settings.directionNav&&(t(".active-container .next-btn").fadeIn().bind("click",function(t){e(t,"next")}),t(".active-container .prev-btn").fadeIn().bind("click",function(t){e(t,"prev")}))},t.ContentGrid.prototype.hideActive=function(){t(".grid-square.active").removeClass("active"),t(".active-container .content").fadeOut("fast",function(){t(".active-container .content").html("")})}}(jQuery);
